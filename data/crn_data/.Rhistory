ylab(TeX('$\\widehat{m}$')) +
ggtitle(plot_names[i]) +
theme(plot.title = element_text(hjust = 0.5)) +
guides(colour = TRUE, shape = FALSE)
ggplot(tree_m_hat_tbl, aes(x = index, y = m_hat, colour = type, shape = type)) +
geom_point() +
scale_color_manual(values=c("#69b3a2", "#404080"), labels=lapply(c('$X_t$', '$X_t^2$'), TeX)) +
guides(colour=guide_legend(title=NULL)) +
#scale_shape_discrete(labels=lapply(c('$X_t$', '$X_t^2$'), TeX)) +
scale_y_continuous(breaks = seq(0, 20, by = 5), lim = c(0, 20), label = c(seq(0, 15, by = 5), '20+')) +
ylab(TeX('$\\widehat{m}$')) +
ggtitle(plot_names[i]) +
theme(plot.title = element_text(hjust = 0.5)) +
guides(color = TRUE, shape = FALSE)
?guides
ggplot(tree_m_hat_tbl, aes(x = index, y = m_hat, colour = type, shape = type)) +
geom_point() +
scale_color_manual(values=c("#69b3a2", "#404080"), labels=lapply(c('$X_t$', '$X_t^2$'), TeX)) +
guides(colour=guide_legend(title=NULL), colour = TRUE, shape = FALSE) +
#scale_shape_discrete(labels=lapply(c('$X_t$', '$X_t^2$'), TeX)) +
scale_y_continuous(breaks = seq(0, 20, by = 5), lim = c(0, 20), label = c(seq(0, 15, by = 5), '20+')) +
ylab(TeX('$\\widehat{m}$')) +
ggtitle(plot_names[i]) +
theme(plot.title = element_text(hjust = 0.5))
ggplot(tree_m_hat_tbl, aes(x = index, y = m_hat, colour = type, shape = type)) +
geom_point() +
scale_color_manual(values=c("#69b3a2", "#404080"), labels=lapply(c('$X_t$', '$X_t^2$'), TeX)) +
guides(colour=guide_legend(title=NULL), colour = F, shape = T) +
#scale_shape_discrete(labels=lapply(c('$X_t$', '$X_t^2$'), TeX)) +
scale_y_continuous(breaks = seq(0, 20, by = 5), lim = c(0, 20), label = c(seq(0, 15, by = 5), '20+')) +
ylab(TeX('$\\widehat{m}$')) +
ggtitle(plot_names[i]) +
theme(plot.title = element_text(hjust = 0.5))
ggplot(tree_m_hat_tbl, aes(x = index, y = m_hat, colour = type, shape = type)) +
geom_point() +
scale_color_manual(values=c("#69b3a2", "#404080"), labels=lapply(c('$X_t$', '$X_t^2$'), TeX)) +
guides(colour=guide_legend(title=NULL), colour = FALSE, shape = TRUE) +
#scale_shape_discrete(labels=lapply(c('$X_t$', '$X_t^2$'), TeX)) +
scale_y_continuous(breaks = seq(0, 20, by = 5), lim = c(0, 20), label = c(seq(0, 15, by = 5), '20+')) +
ylab(TeX('$\\widehat{m}$')) +
ggtitle(plot_names[i]) +
theme(plot.title = element_text(hjust = 0.5))
ggplot(tree_m_hat_tbl, aes(x = index, y = m_hat, colour = type, shape = type)) +
geom_point() +
scale_color_manual(values=c("#69b3a2", "#404080"), labels=lapply(c('$X_t$', '$X_t^2$'), TeX)) +
guides(colour=guide_legend(title=NULL), colour = TRUE, shape = TRUE) +
#scale_shape_discrete(labels=lapply(c('$X_t$', '$X_t^2$'), TeX)) +
scale_y_continuous(breaks = seq(0, 20, by = 5), lim = c(0, 20), label = c(seq(0, 15, by = 5), '20+')) +
ylab(TeX('$\\widehat{m}$')) +
ggtitle(plot_names[i]) +
theme(plot.title = element_text(hjust = 0.5))
ggplot(tree_m_hat_tbl, aes(x = index, y = m_hat, colour = type, shape = type)) +
geom_point() +
scale_color_manual(values=c("#69b3a2", "#404080"), labels=lapply(c('$X_t$', '$X_t^2$'), TeX)) +
guides(colour=guide_legend(title=NULL), colour = TRUE, shape = FALSE) +
#scale_shape_discrete(labels=lapply(c('$X_t$', '$X_t^2$'), TeX)) +
scale_y_continuous(breaks = seq(0, 20, by = 5), lim = c(0, 20), label = c(seq(0, 15, by = 5), '20+')) +
ylab(TeX('$\\widehat{m}$')) +
ggtitle(plot_names[i]) +
theme(plot.title = element_text(hjust = 0.5))
ggplot(tree_m_hat_tbl, aes(x = index, y = m_hat, colour = type, shape = type)) +
geom_point() +
scale_color_manual(values=c("#69b3a2", "#404080"), labels=lapply(c('$X_t$', '$X_t^2$'), TeX)) +
guides(colour=guide_legend(title=NULL), shape = FALSE) +
#scale_shape_discrete(labels=lapply(c('$X_t$', '$X_t^2$'), TeX)) +
scale_y_continuous(breaks = seq(0, 20, by = 5), lim = c(0, 20), label = c(seq(0, 15, by = 5), '20+')) +
ylab(TeX('$\\widehat{m}$')) +
ggtitle(plot_names[i]) +
theme(plot.title = element_text(hjust = 0.5))
ggplot(tree_m_hat_tbl, aes(x = index, y = m_hat, colour = type, shape = type)) +
geom_point() +
scale_color_manual(values=c("#69b3a2", "#404080"), labels=lapply(c('$X_t$', '$X_t^2$'), TeX))
ggplot(tree_m_hat_tbl, aes(x = index, y = m_hat, colour = type, shape = type)) +
geom_point() +
scale_color_manual(values=c("#69b3a2", "#404080"), labels=lapply(c('$X_t$', '$X_t^2$'), TeX)) +
scale_shape_manual(labels=lapply(c('$X_t$', '$X_t^2$'), TeX))
ggplot(tree_m_hat_tbl, aes(x = index, y = m_hat, colour = type, shape = type)) +
geom_point() +
scale_color_manual(values=c("#69b3a2", "#404080"), labels=lapply(c('$X_t$', '$X_t^2$'), TeX)) +
scale_shape_manual(values = c(19, 17), labels=lapply(c('$X_t$', '$X_t^2$'), TeX))
ggplot(tree_m_hat_tbl, aes(x = index, y = m_hat, colour = type, shape = type)) +
geom_point() +
scale_color_manual(name = 'type',
values=c("#69b3a2", "#404080"),
labels=lapply(c('$X_t$', '$X_t^2$'), TeX)) +
scale_shape_manual(name = 'type',
values = c(19, 17),
labels=lapply(c('$X_t$', '$X_t^2$'), TeX))
ggplot(tree_m_hat_tbl, aes(x = index, y = m_hat, colour = type, shape = type)) +
geom_point() +
scale_color_manual(name = 'type',
values=c("#69b3a2", "#404080"),
labels=lapply(c('$X_t$', '$X_t^2$'), TeX)) +
scale_shape_manual(name = 'type',
values = c(19, 17),
labels=lapply(c('$X_t$', '$X_t^2$'), TeX))
ggplot(tree_m_hat_tbl, aes(x = index, y = m_hat, colour = type, shape = type)) +
geom_point() +
scale_color_manual(name = 'type',
values=c("#69b3a2", "#404080"),
labels=c(1,2)) +
scale_shape_manual(name = 'type',
values = c(19, 17),
labels=c(1,2))
ggplot(tree_m_hat_tbl, aes(x = index, y = m_hat, colour = type, shape = type)) +
geom_point() +
scale_color_manual(name = 'type',
values=c("#69b3a2", "#404080"),
labels=c('$X_t$', '$X_t^2$')) +
scale_shape_manual(name = 'type',
values = c(19, 17),
labels=c('$X_t$', '$X_t^2$'))
ggplot(tree_m_hat_tbl, aes(x = index, y = m_hat, colour = type, shape = type)) +
geom_point() +
scale_color_manual(name = 'type',
values=c("#69b3a2", "#404080"),
labels=c(TeX('$X_t$'), TeX('$X_t^2$'))) +
scale_shape_manual(name = 'type',
values = c(19, 17),
labels=c(TeX('$X_t$'), TeX('$X_t^2$')))
c(TeX('$X_t$'), TeX('$X_t^2$'))
ggplot(tree_m_hat_tbl, aes(x = index, y = m_hat, colour = type, shape = type)) +
geom_point() +
scale_color_manual(name = 'type',
values=c("#69b3a2", "#404080"),
labels=c(TeX('$X_t$'), TeX('$X_t^2$')))
ggplot(tree_m_hat_tbl, aes(x = index, y = m_hat, colour = type, shape = type)) +
geom_point() +
labs(colour  = "Guide name", shape = "Guide name")
ggplot(tree_m_hat_tbl, aes(x = index, y = m_hat, colour = type, shape = type)) +
geom_point() +
labs(colour  = "Guide name", shape = "Guide name") +
scale_color_manual(name = 'type',
values=c("#69b3a2", "#404080"),
labels=lapply(c('$X_t$', '$X_t^2$'),TeX))
ggplot(tree_m_hat_tbl, aes(x = index, y = m_hat, colour = type, shape = type)) +
geom_point() +
scale_color_manual(name = 'type',
values=c("#69b3a2", "#404080"),
labels=lapply(c('$X_t$', '$X_t^2$'),TeX)) +
scale_shape_manual(name = 'type',
values = c(19, 17),
labels=lapply(c('$X_t$', '$X_t^2$'),TeX)) +
labs(colour  = "Guide name", shape = "Guide name")
ggplot(tree_m_hat_tbl, aes(x = index, y = m_hat, colour = type, shape = type)) +
geom_point() +
labs(colour  = "", shape = "")
?labs
ggplot(tree_m_hat_tbl, aes(x = index, y = m_hat, colour = type, shape = type)) +
geom_point() +
labs(colour  = "", shape = "", labels=lapply(c('$X_t$', '$X_t^2$'),TeX)))
ggplot(tree_m_hat_tbl, aes(x = index, y = m_hat, colour = type, shape = type)) +
geom_point() +
labs(colour  = "", shape = "", labels=lapply(c('$X_t$', '$X_t^2$'),TeX))
ggplot(tree_m_hat_tbl, aes(x = index, y = m_hat, colour = type, shape = type)) +
geom_point() +
labs(colour  = "", shape = "", labels=lapply(c('$X_t$', '$X_t^2$'),TeX))
scale_color_manual(name = 'type',
values=c("#69b3a2", "#404080"),
labels=TeX(c('$X_t$', '$X_t^2$')))
ggplot(tree_m_hat_tbl, aes(x = index, y = m_hat, colour = type, shape = type)) +
geom_point() +
#labs(colour  = "", shape = "", labels=lapply(c('$X_t$', '$X_t^2$'),TeX))
scale_color_manual(name = 'type',
values=c("#69b3a2", "#404080"),
labels=TeX(c('$X_t$', '$X_t^2$')))
ggplot(tree_m_hat_tbl, aes(x = index, y = m_hat, colour = type, shape = type)) +
geom_point() +
#labs(colour  = "", shape = "", labels=lapply(c('$X_t$', '$X_t^2$'),TeX))
scale_color_manual(name = 'type',
values=c("#69b3a2", "#404080"),
labels= unname(TeX(c('$X_t$', '$X_t^2$'))))
ggplot(tree_m_hat_tbl, aes(x = index, y = m_hat, colour = type, shape = type)) +
geom_point() +
#labs(colour  = "", shape = "", labels=lapply(c('$X_t$', '$X_t^2$'),TeX))
scale_color_manual(name = 'type',
values=c("#69b3a2", "#404080"),
labels= unname(TeX(c('$X_t$', '$X_t^2$')))) +
scale_shape_manual(name = 'type',
values = c(19, 17),
labels=unname(TeX(c('$X_t$', '$X_t^2$'))))
TeX(c('$X_t$', '$X_t^2$'))
unname(TeX(c('$X_t$', '$X_t^2$')))
ggplot(tree_m_hat_tbl, aes(x = index, y = m_hat, colour = type, shape = type)) +
geom_point() +
#labs(colour  = "", shape = "", labels=lapply(c('$X_t$', '$X_t^2$'),TeX))
scale_color_manual(name = '',
values=c("#69b3a2", "#404080"),
labels= unname(TeX(c('$X_t$', '$X_t^2$')))) +
scale_shape_manual(name = '',
values = c(19, 17),
labels=unname(TeX(c('$X_t$', '$X_t^2$')))
ggplot(tree_m_hat_tbl, aes(x = index, y = m_hat, colour = type, shape = type)) +
geom_point() +
#labs(colour  = "", shape = "", labels=lapply(c('$X_t$', '$X_t^2$'),TeX))
scale_color_manual(name = '',
values=c("#69b3a2", "#404080"),
labels= unname(TeX(c('$X_t$', '$X_t^2$')))) +
scale_shape_manual(name = '',
values = c(19, 17),
labels=unname(TeX(c('$X_t$', '$X_t^2$')))) +
labs(colour  = "", shape = "")
ggplot(tree_m_hat_tbl, aes(x = index, y = m_hat, colour = type)) +
geom_point(aes(shape=type))
ggplot(tree_m_hat_tbl, aes(x = index, y = m_hat, colour = type)) +
geom_point(aes(shape=type)) +
#labs(colour  = "", shape = "", labels=lapply(c('$X_t$', '$X_t^2$'),TeX))
scale_color_manual(name = '',
values=c("#69b3a2", "#404080"),
labels= unname(TeX(c('$X_t$', '$X_t^2$'))))
ggplot(tree_m_hat_tbl, aes(x = index, y = m_hat, colour = type)) +
geom_point(aes(shape=type)) +
#labs(colour  = "", shape = "", labels=lapply(c('$X_t$', '$X_t^2$'),TeX))
scale_colour_manual(name = '',
values=c("#69b3a2", "#404080"),
labels= unname(TeX(c('$X_t$', '$X_t^2$'))))
ggplot(tree_m_hat_tbl, aes(x = index, y = m_hat, colour = type)) +
geom_point(aes(shape=type)) +
#labs(colour  = "", shape = "", labels=lapply(c('$X_t$', '$X_t^2$'),TeX))
scale_colour_manual(name = '',
values=c("#69b3a2", "#404080"),
labels= unname(TeX(c('$X_t$', '$X_t^2$')))) +
scale_shape_manual(name = '',
values = c(19, 17),
labels=unname(TeX(c('$X_t$', '$X_t^2$'))))
ggplot(tree_m_hat_tbl, aes(x = index, y = m_hat, colour = type)) +
geom_point(aes(shape=type)) +
scale_colorr_hue(labels = unname(TeX(c('$X_t$', '$X_t^2$'))))
ggplot(tree_m_hat_tbl, aes(x = index, y = m_hat, colour = type)) +
geom_point(aes(shape=type)) +
scale_colour_hue(labels = unname(TeX(c('$X_t$', '$X_t^2$'))))
ggplot(tree_m_hat_tbl, aes(x = index, y = m_hat, colour = type)) +
geom_point() +
scale_colour_manual(name = '',
values=c("#69b3a2", "#404080"),
labels= unname(TeX(c('$X_t$', '$X_t^2$'))))
ggplot(tree_m_hat_tbl, aes(x = index, y = m_hat, colour = type)) +
geom_point() +
scale_colour_manual(name = '',
values=c("#69b3a2", "#404080"),
labels= unname(TeX(c('$X_t$', '$X_t^2$')))) +
scale_y_continuous(breaks = seq(0, 20, by = 5), lim = c(0, 20), label = c(seq(0, 15, by = 5), '20+')) +
ylab(TeX('$\\widehat{m}$')) +
ggtitle(plot_names[i]) +
theme(plot.title = element_text(hjust = 0.5)) +
guides(color = TRUE, shape = FALSE)
ggplot(tree_m_hat_tbl, aes(x = index, y = m_hat, colour = type)) +
geom_point() +
scale_colour_manual(name = '',
values=c("#69b3a2", "#404080"),
labels= unname(TeX(c('$X_t$', '$X_t^2$')))) +
scale_y_continuous(breaks = seq(0, 20, by = 5), lim = c(0, 20), label = c(seq(0, 15, by = 5), '20+')) +
ylab(TeX('$\\widehat{m}$')) +
ggtitle(plot_names[i]) +
theme(plot.title = element_text(hjust = 0.5))
### Hermite Hermite Rank Estimation Comparison Plot for Xt vs Xt^2
plot_names <- c('Samplewise Comparison (Local Whittle)',
'Samplewise Comparison (Log-periodogram)')
hist_names <- c('Histogram Comparison for Tree Rings (Local Whittle)',
'Histogram Comparison for Tree Rings (Log-periodogram)')
sim_names <- c('Histogram Comparison for Simulations (Local Whittle)',
'Histogram Comparison for Simulations (Log-periodogram)')
### for two different am estimation methods: Whittle, log-periodogram
Treering_plot_list <- list()
tree_sim_comparison <- list()
for(i in c(1,2)){
tree_sim_comparison[[i]] <- list()
### count the frequency of m_hat(Xt) > m_hat(Xt^2)
tree_sim_comparison[[i]]$tree_m_comparison <- sapply(tree_est_list[[i]], function(lst){
lst$m_int_hat
}) %>%
t() %>%
as_tibble() %>%
`colnames<-`(c('Xt', 'Xt2')) %>%
apply(1, function(x){
if(x[2]>x[1]){
return(1)
}else if(x[2] == x[1]){
return(0)
}else{
return(-1)
}
}) %>%
table()
# m_comparision for simulations
tree_sim_comparison[[i]]$sim_m_comparison <- sapply(tree_est_list[[i]], function(lst){
lst$sim_est %>%
apply(1, function(x){
if(x[2]>x[1]){
return(1)
}else if(x[2] == x[1]){
return(0)
}else{
return(-1)
}
}) %>%
table()
}) %>%
t() %>%
colSums()
### plots for Hermite rank estimation of tree rings data
# remark: type 1 for Xt and type 2 for Xt^2
tree_m_hat_tbl <- sapply(tree_est_list[[i]], function(lst){
lst$m_int_hat
}) %>%
t() %>%
as_tibble() %>%
`colnames<-`(c(1,2)) %>%
pivot_longer(cols = everything(), names_to = 'type', values_to = 'm_hat') %>%
dplyr::mutate(m_hat = ifelse(m_hat>20, 20, m_hat),
index = rep.int(rep(seq(1, 0.5*n())),
times = rep(2, times= 0.5*n())))
Treering_plot_list[[i]] <- list()
Treering_plot_list[[i]][[1]] <- ggplot(tree_m_hat_tbl, aes(x = index, y = m_hat, colour = type)) +
geom_point() +
scale_colour_manual(name = '',
values=c("#69b3a2", "#404080"),
labels= unname(TeX(c('$X_t$', '$X_t^2$')))) +
scale_y_continuous(breaks = seq(0, 20, by = 5), lim = c(0, 20), label = c(seq(0, 15, by = 5), '20+')) +
ylab(TeX('$\\widehat{m}$')) +
ggtitle(plot_names[i]) +
theme(plot.title = element_text(hjust = 0.5))
tree_m_hat_tbl <- tree_m_hat_tbl %>%
dplyr::mutate(m_hat_trunc = ifelse(m_hat>=10, 10, m_hat))
Treering_plot_list[[i]][[2]] <- ggplot(tree_m_hat_tbl , aes(x=m_hat_trunc, fill=type)) +
geom_histogram( color="#e9ecef", alpha=0.4, position = 'identity', binwidth = 1) +
guides(fill=guide_legend(title=NULL)) +
scale_fill_manual(values=c("#69b3a2", "#404080"), labels=lapply(c('$X_t$', '$X_t^2$'), TeX)) +
scale_x_continuous(breaks = seq(1, 10), lim = c(0, 11), labels = c(1:9, '9+')) +
scale_y_continuous(breaks = c(0, 100, 200, 300), lim = c(0, 300)) +
xlab(TeX('$\\widehat{m}$')) +
ggtitle(hist_names[i]) +
theme(plot.title = element_text(hjust = 0.5))
### plots for Hermite rank estimation of simulated FGuassian
sim_m_hat_tbl <- lapply(tree_est_list[[i]], function(lst){
lst$sim_est
}) %>%
Reduce(f = rbind) %>%
apply(2, function(m){
ifelse(m>=10, 10, m)
}) %>%
as_tibble() %>%
`colnames<-`(c(1,2)) %>%
pivot_longer(cols = everything(), names_to = 'type', values_to = 'm_hat')
Treering_plot_list[[i]][[3]] <- ggplot(sim_m_hat_tbl , aes(x=m_hat, fill=type)) +
geom_histogram( color="#e9ecef", alpha=0.4, position = 'identity', binwidth = 1) +
guides(fill=guide_legend(title=NULL)) +
scale_fill_manual(values=c("#69b3a2", "#404080"), labels=lapply(c('$X_t$', '$X_t^2$'), TeX)) +
scale_x_continuous(breaks = seq(1, 10), lim = c(0, 11), labels = c(1:9, '9+')) +
scale_y_continuous(breaks = c(0, 10000, 20000, 30000), lim = c(0, 32000)) +
xlab(TeX('$\\widehat{m}$')) +
ggtitle(sim_names[i]) +
theme(plot.title = element_text(hjust = 0.5))
### Chi-square test for comparing two histograms
sim_m_hat_freq <- sim_m_hat_tbl %>%
group_by(type, m_hat) %>%
summarise(n = n()) %>%
mutate(freq = n/sum(n))
tree_m_hat_freq <- tree_m_hat_tbl %>%
group_by(type, m_hat_trunc) %>%
summarise(n = n()) %>%
mutate(freq = n/sum(n))
tree_sim_comparison[[i]]$Chisq_pvalues <- sapply(c(1, 2), function(j){
sim_subset <- sim_m_hat_freq %>%
filter(type == j) %>%
select(freq, n)
tree_subset <- tree_m_hat_freq %>%
filter(type == j) %>%
select(freq, n)
# chi-square test between hist of Simultions vs tree ring for Xt and Xt^2
chi_stat <- sum((sim_subset$freq - tree_subset$freq)^2/
(sim_subset$freq/sum(sim_subset$n) + tree_subset$freq/sum(tree_subset$n)))
p_value <- 1- pchisq(chi_stat, df = 9, lower.tail = T)
}) %>%
`names<-`(c('Xt','Xt2'))
}
#tree_sim_comparison
# merge plots
TreeRing_plot <- grid.arrange(Treering_plot_list[[1]][[1]], Treering_plot_list[[2]][[1]],
Treering_plot_list[[1]][[2]], Treering_plot_list[[2]][[2]],
Treering_plot_list[[1]][[3]], Treering_plot_list[[2]][[3]], nrow = 3)
ggplot(tree_m_hat_tbl, aes(x = index, y = m_hat, colour = type)) +
geom_point() +
scale_colour_manual(name = '',
values=c("#69b3a2", "#404080"),
labels= lapply(c('$X_t$', '$X_t^2$'), TeX)) +
scale_y_continuous(breaks = seq(0, 20, by = 5), lim = c(0, 20), label = c(seq(0, 15, by = 5), '20+')) +
ylab(TeX('$\\widehat{m}$')) +
ggtitle(plot_names[i]) +
theme(plot.title = element_text(hjust = 0.5))
### for two different am estimation methods: Whittle, log-periodogram
Treering_plot_list <- list()
tree_sim_comparison <- list()
for(i in c(1,2)){
tree_sim_comparison[[i]] <- list()
### count the frequency of m_hat(Xt) > m_hat(Xt^2)
tree_sim_comparison[[i]]$tree_m_comparison <- sapply(tree_est_list[[i]], function(lst){
lst$m_int_hat
}) %>%
t() %>%
as_tibble() %>%
`colnames<-`(c('Xt', 'Xt2')) %>%
apply(1, function(x){
if(x[2]>x[1]){
return(1)
}else if(x[2] == x[1]){
return(0)
}else{
return(-1)
}
}) %>%
table()
# m_comparision for simulations
tree_sim_comparison[[i]]$sim_m_comparison <- sapply(tree_est_list[[i]], function(lst){
lst$sim_est %>%
apply(1, function(x){
if(x[2]>x[1]){
return(1)
}else if(x[2] == x[1]){
return(0)
}else{
return(-1)
}
}) %>%
table()
}) %>%
t() %>%
colSums()
### plots for Hermite rank estimation of tree rings data
# remark: type 1 for Xt and type 2 for Xt^2
tree_m_hat_tbl <- sapply(tree_est_list[[i]], function(lst){
lst$m_int_hat
}) %>%
t() %>%
as_tibble() %>%
`colnames<-`(c(1,2)) %>%
pivot_longer(cols = everything(), names_to = 'type', values_to = 'm_hat') %>%
dplyr::mutate(m_hat = ifelse(m_hat>20, 20, m_hat),
index = rep.int(rep(seq(1, 0.5*n())),
times = rep(2, times= 0.5*n())))
Treering_plot_list[[i]] <- list()
Treering_plot_list[[i]][[1]] <- ggplot(tree_m_hat_tbl, aes(x = index, y = m_hat, colour = type)) +
geom_point() +
scale_colour_manual(name = '',
values=c("#69b3a2", "#404080"),
labels= lapply(c('$X_t$', '$X_t^2$'), TeX)) +
scale_y_continuous(breaks = seq(0, 20, by = 5), lim = c(0, 20), label = c(seq(0, 15, by = 5), '20+')) +
ylab(TeX('$\\widehat{m}$')) +
ggtitle(plot_names[i]) +
theme(plot.title = element_text(hjust = 0.5))
tree_m_hat_tbl <- tree_m_hat_tbl %>%
dplyr::mutate(m_hat_trunc = ifelse(m_hat>=10, 10, m_hat))
Treering_plot_list[[i]][[2]] <- ggplot(tree_m_hat_tbl , aes(x=m_hat_trunc, fill=type)) +
geom_histogram( color="#e9ecef", alpha=0.4, position = 'identity', binwidth = 1) +
guides(fill=guide_legend(title=NULL)) +
scale_fill_manual(values=c("#69b3a2", "#404080"), labels=lapply(c('$X_t$', '$X_t^2$'), TeX)) +
scale_x_continuous(breaks = seq(1, 10), lim = c(0, 11), labels = c(1:9, '9+')) +
scale_y_continuous(breaks = c(0, 100, 200, 300), lim = c(0, 300)) +
xlab(TeX('$\\widehat{m}$')) +
ggtitle(hist_names[i]) +
theme(plot.title = element_text(hjust = 0.5))
### plots for Hermite rank estimation of simulated FGuassian
sim_m_hat_tbl <- lapply(tree_est_list[[i]], function(lst){
lst$sim_est
}) %>%
Reduce(f = rbind) %>%
apply(2, function(m){
ifelse(m>=10, 10, m)
}) %>%
as_tibble() %>%
`colnames<-`(c(1,2)) %>%
pivot_longer(cols = everything(), names_to = 'type', values_to = 'm_hat')
Treering_plot_list[[i]][[3]] <- ggplot(sim_m_hat_tbl , aes(x=m_hat, fill=type)) +
geom_histogram( color="#e9ecef", alpha=0.4, position = 'identity', binwidth = 1) +
guides(fill=guide_legend(title=NULL)) +
scale_fill_manual(values=c("#69b3a2", "#404080"), labels=lapply(c('$X_t$', '$X_t^2$'), TeX)) +
scale_x_continuous(breaks = seq(1, 10), lim = c(0, 11), labels = c(1:9, '9+')) +
scale_y_continuous(breaks = c(0, 10000, 20000, 30000), lim = c(0, 32000)) +
xlab(TeX('$\\widehat{m}$')) +
ggtitle(sim_names[i]) +
theme(plot.title = element_text(hjust = 0.5))
### Chi-square test for comparing two histograms
sim_m_hat_freq <- sim_m_hat_tbl %>%
group_by(type, m_hat) %>%
summarise(n = n()) %>%
mutate(freq = n/sum(n))
tree_m_hat_freq <- tree_m_hat_tbl %>%
group_by(type, m_hat_trunc) %>%
summarise(n = n()) %>%
mutate(freq = n/sum(n))
tree_sim_comparison[[i]]$Chisq_pvalues <- sapply(c(1, 2), function(j){
sim_subset <- sim_m_hat_freq %>%
filter(type == j) %>%
select(freq, n)
tree_subset <- tree_m_hat_freq %>%
filter(type == j) %>%
select(freq, n)
# chi-square test between hist of Simultions vs tree ring for Xt and Xt^2
chi_stat <- sum((sim_subset$freq - tree_subset$freq)^2/
(sim_subset$freq/sum(sim_subset$n) + tree_subset$freq/sum(tree_subset$n)))
p_value <- 1- pchisq(chi_stat, df = 9, lower.tail = T)
}) %>%
`names<-`(c('Xt','Xt2'))
}
#tree_sim_comparison
# merge plots
TreeRing_plot <- grid.arrange(Treering_plot_list[[1]][[1]], Treering_plot_list[[2]][[1]],
Treering_plot_list[[1]][[2]], Treering_plot_list[[2]][[2]],
Treering_plot_list[[1]][[3]], Treering_plot_list[[2]][[3]], nrow = 3)
ggsave("TreeRing_plot.png", plot = TreeRing_plot,  width = 11, height = 10.5)
ggsave("TreeRing_plot.png", plot = TreeRing_plot,  width = 11, height = 10.5)
getwd()
